#!/usr/bin/env node
import*as O from"fs";import*as g from"path";import*as l from"url";import{transformSync as R}from"esbuild";let h;function w(t){h=t}async function y(t,s,e){if(!(t.startsWith(".")||t.startsWith("/"))&&h){const{baseUrl:r,paths:a,tsconfigDir:u}=h;for(const i of Object.keys(a)){let o=null;if(i.endsWith("/*")){const c=i.slice(0,-2);if(t.startsWith(c)){const n=t.slice(c.length);(n===""||n.startsWith("/"))&&(o=n,o.startsWith("/")&&(o=o.slice(1)))}}else t===i&&(o="");if(o!==null)for(const c of a[i]){const n=c.replace(/\*/g,o),m=r??u;if(m){const U=l.pathToFileURL(g.join(m,"dummy.ts")).href;try{return{...await y(`./${n}`,{parentURL:U},e),shortCircuit:!0}}catch(f){if(f.code!=="ERR_MODULE_NOT_FOUND")throw f}}}}if(r){const i=l.pathToFileURL(g.join(r,"dummy.ts")).href;try{return{...await y(`./${t}`,{parentURL:i},e),shortCircuit:!0}}catch(o){if(o.code!=="ERR_MODULE_NOT_FOUND")throw o}}}try{return{...await e(t,s),shortCircuit:!0}}catch(r){if(r.code!=="ERR_MODULE_NOT_FOUND")throw r}try{return{...await e(t+".ts",s),shortCircuit:!0}}catch(r){if(r.code!=="ERR_MODULE_NOT_FOUND")throw r}try{return{...await e(t+".tsx",s),shortCircuit:!0}}catch(r){if(r.code!=="ERR_MODULE_NOT_FOUND")throw r}try{return{...await e(t+"/index.ts",s),shortCircuit:!0}}catch(r){if(r.code!=="ERR_MODULE_NOT_FOUND")throw r}try{return{...await e(t+"/index.tsx",s),shortCircuit:!0}}catch(r){throw r}}async function p(t,s,e){if(!t.endsWith(".ts")&&!t.endsWith(".tsx"))return e(t,s);const d=t.endsWith(".tsx")?"tsx":"ts",r=l.fileURLToPath(t),a=O.readFileSync(r,"utf8"),{code:u}=R(a,{loader:d,format:"esm",target:`node${process.versions.node}`,sourcemap:"inline",sourcefile:r,banner:`
import { createRequire } from 'module';
const require = createRequire(import.meta.url);`});return{format:"module",source:u,shortCircuit:!0}}export{w as initialize,p as load,y as resolve};
